{"ast":null,"code":"import _toConsumableArray from \"/Users/julienassouline/Documents/538_dashboard/endorsements/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/julienassouline/Documents/538_dashboard/endorsements/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/julienassouline/Documents/538_dashboard/endorsements/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/julienassouline/Documents/538_dashboard/endorsements/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/julienassouline/Documents/538_dashboard/endorsements/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/julienassouline/Documents/538_dashboard/endorsements/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/julienassouline/Documents/538_dashboard/endorsements/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/julienassouline/Documents/538_dashboard/endorsements/src/TotalTable.js\";\nimport data from './endorsements-2020.csv';\n\nvar React = require(\"react\");\n\nvar d3 = require(\"d3\");\n\nvar _ = require('lodash');\n\nfunction isSearched(searchTerm) {\n  return function (item) {\n    return item.state.toLowerCase().includes(searchTerm.toLowerCase().trim()) || item.position.toLowerCase().includes(searchTerm.toLowerCase().trim()) || item.endorser.toLowerCase().includes(searchTerm.toLowerCase().trim());\n  };\n}\n\nvar TotalTable =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(TotalTable, _React$Component);\n\n  function TotalTable(props) {\n    var _this;\n\n    _classCallCheck(this, TotalTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TotalTable).call(this, props));\n    _this.anchorRef = React.createRef();\n    _this.state = {\n      data: [],\n      direction: \"desc\",\n      value: \"Search by position, state, or endorser\",\n      totalTableMore: true\n    };\n    _this.sortTable = _this.sortTable.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onSearchChange = _this.onSearchChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.searchClick = _this.searchClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showMoreTotal = _this.showMoreTotal.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.showLessTotal = _this.showLessTotal.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(TotalTable, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      d3.csv(data).then(function (data) {\n        data.forEach(function (d) {\n          return d.points = +d.points;\n        });\n        data.sort(function (a, b) {\n          return b.points - a.points;\n        });\n\n        _this2.setState({\n          data: data\n        });\n      });\n    }\n  }, {\n    key: \"onSearchChange\",\n    value: function onSearchChange(event) {\n      this.setState({\n        value: event.target.value\n      });\n    }\n  }, {\n    key: \"searchClick\",\n    value: function searchClick() {\n      this.setState({\n        value: \"\"\n      });\n    }\n  }, {\n    key: \"sortTable\",\n    value: function sortTable(event, sortKey) {\n      var direction = this.state.direction === 'asc' ? 'desc' : 'asc';\n      var dataSorted = this.state.data;\n\n      if (sortKey === \"points\") {\n        console.log(direction === \"desc\");\n        direction === \"desc\" ? dataSorted.sort(function (a, b) {\n          return b.points - a.points;\n        }) : dataSorted.sort(function (a, b) {\n          return a.points - b.points;\n        });\n        this.setState({\n          dataSorted: dataSorted,\n          direction: direction\n        });\n      } else {\n        dataSorted.sort(function (a, b) {\n          var nameA = a[sortKey].toUpperCase(); // ignore upper and lowercase\n\n          var nameB = b[sortKey].toUpperCase(); // ignore upper and lowercase\n\n          if (nameA < nameB) {\n            return -1;\n          }\n\n          if (nameA > nameB) {\n            return 1;\n          } // names must be equal\n\n\n          return 0;\n        });\n\n        if (direction === 'desc') {\n          dataSorted.reverse();\n        }\n\n        this.setState({\n          dataSorted: dataSorted,\n          direction: direction\n        });\n      }\n    }\n  }, {\n    key: \"showMoreTotal\",\n    value: function showMoreTotal() {\n      this.setState({\n        totalTableMore: false\n      });\n    }\n  }, {\n    key: \"showLessTotal\",\n    value: function showLessTotal() {\n      this.setState({\n        totalTableMore: false\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.data.length > 0) {\n        var data = this.state.data;\n        var columns = [\"points\", \"position\", \"state\", \"endorser\", \"endorsee\", \"date\"];\n\n        var dataFiltered = _.map(data, function (d) {\n          return _.omit(d, ['city', 'category', \"body\", \"district\", \"endorser party\", \"order\", \"source\", \"index\"]);\n        });\n\n        if (this.state.totalTableMore === true) {\n          dataFiltered.forEach(function (d, i) {\n            d.index = i;\n          });\n          dataFiltered = dataFiltered.filter(function (d) {\n            return d.index < 15;\n          });\n        }\n\n        var dataNew = this.state.value === \"Search by position, state, or endorser\" ? dataFiltered : dataFiltered.filter(isSearched(this.state.value));\n      }\n\n      var points_array = _toConsumableArray(Array(11).keys());\n\n      points_array.shift();\n      var colors = d3.scaleOrdinal().domain(points_array).range([\"#c2dbef\", \"#b3d2eb\", \"#a3c9e7\", \"#94c0e3\", \"#84b7de\", \"#75adda\", \"#65a4d6\", \"#569bd2\", \"#4692ce\", \"#3689ca\"]);\n\n      String.prototype.capitalize = function () {\n        return this.charAt(0).toUpperCase() + this.slice(1);\n      };\n\n      var total_table = document.getElementById(\"total_button\");\n\n      if (total_table !== null) {\n        this.state.totalTableMore === true ? total_table.innerText = \"Show More\" : total_table.innerText = \"Show Less\";\n      }\n\n      return React.createElement(\"div\", {\n        className: \"table_input\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        onClick: this.searchClick,\n        ref: function ref(node) {\n          return _this3.node = node;\n        },\n        className: \"seachbox\",\n        type: \"text\",\n        onBlur: this.onSearchChange,\n        placeholder: \"Search by position, state, or endorser\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          height: 50\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      })), React.createElement(\"table\", {\n        className: \"table\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        id: \"headers\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, columns !== undefined ? columns.map(function (d, i) {\n        return React.createElement(\"th\", {\n          className: \"total_headers\",\n          onClick: function onClick(e) {\n            return _this3.sortTable(e, d);\n          },\n          key: \"columns\" + i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        }, d.capitalize(), React.createElement(\"div\", {\n          className: \"sortdir\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"desc\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170\n          },\n          __self: this\n        }, \"\\u25B2\"), React.createElement(\"div\", {\n          className: \"asc\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, \"\\u25BC\")));\n      }) : null)), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, dataNew !== undefined ? dataNew.map(function (d, i) {\n        return React.createElement(\"tr\", {\n          key: \"row\" + i,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        }, dataNew !== undefined ? columns.map(function (col, i) {\n          return React.createElement(\"td\", {\n            key: col,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185\n            },\n            __self: this\n          }, \" \", React.createElement(\"span\", {\n            className: col === \"points\" ? \"points\" : \"others\",\n            style: {\n              background: col === \"points\" ? colors(d[col]) : \"white\",\n              color: col === \"points\" ? \"white\" : d.endorsee !== \"\" ? \"black\" : \"#999\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185\n            },\n            __self: this\n          }, \" \", d[col], \" \"), \" \");\n        }) : null);\n      }) : null)), React.createElement(\"button\", {\n        onClick: this.state.totalTableMore === false ? this.showMoreTotal : this.showLessTotal,\n        id: \"total_button\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, \" Show More \"));\n    }\n  }]);\n\n  return TotalTable;\n}(React.Component);\n\nexport default TotalTable;","map":{"version":3,"sources":["/Users/julienassouline/Documents/538_dashboard/endorsements/src/TotalTable.js"],"names":["data","React","require","d3","_","isSearched","searchTerm","item","state","toLowerCase","includes","trim","position","endorser","TotalTable","props","anchorRef","createRef","direction","value","totalTableMore","sortTable","bind","onSearchChange","searchClick","showMoreTotal","showLessTotal","csv","then","forEach","d","points","sort","a","b","setState","event","target","sortKey","dataSorted","console","log","nameA","toUpperCase","nameB","reverse","length","columns","dataFiltered","map","omit","i","index","filter","dataNew","points_array","Array","keys","shift","colors","scaleOrdinal","domain","range","String","prototype","capitalize","charAt","slice","total_table","document","getElementById","innerText","node","height","undefined","e","col","background","color","endorsee","Component"],"mappings":";;;;;;;;AAAA,OAAOA,IAAP,MAAiB,yBAAjB;;AACA,IAAMC,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,IAAMC,EAAE,GAAGD,OAAO,CAAC,IAAD,CAAlB;;AACA,IAAME,CAAC,GAAGF,OAAO,CAAC,QAAD,CAAjB;;AAEA,SAASG,UAAT,CAAoBC,UAApB,EAAgC;AAC9B,SAAO,UAASC,IAAT,EAAe;AACpB,WAAQA,IAAI,CAACC,KAAL,CAAWC,WAAX,GAAyBC,QAAzB,CAAkCJ,UAAU,CAACG,WAAX,GAAyBE,IAAzB,EAAlC,KAAsEJ,IAAI,CAACK,QAAL,CAAcH,WAAd,GAA4BC,QAA5B,CAAqCJ,UAAU,CAACG,WAAX,GAAyBE,IAAzB,EAArC,CAAtE,IAA+IJ,IAAI,CAACM,QAAL,CAAcJ,WAAd,GAA4BC,QAA5B,CAAqCJ,UAAU,CAACG,WAAX,GAAyBE,IAAzB,EAArC,CAAvJ;AACD,GAFD;AAGD;;IAGKG,U;;;;;AACJ,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,oFAAMA,KAAN;AADiB,UAenBC,SAfmB,GAePf,KAAK,CAACgB,SAAN,EAfO;AAEjB,UAAKT,KAAL,GAAa;AACXR,MAAAA,IAAI,EAAE,EADK;AAEXkB,MAAAA,SAAS,EAAE,MAFA;AAGXC,MAAAA,KAAK,EAAE,wCAHI;AAIXC,MAAAA,cAAc,EAAE;AAJL,KAAb;AAMA,UAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeC,IAAf,uDAAjB;AACA,UAAKC,cAAL,GAAsB,MAAKA,cAAL,CAAoBD,IAApB,uDAAtB;AACA,UAAKE,WAAL,GAAmB,MAAKA,WAAL,CAAiBF,IAAjB,uDAAnB;AACA,UAAKG,aAAL,GAAqB,MAAKA,aAAL,CAAmBH,IAAnB,uDAArB;AACA,UAAKI,aAAL,GAAqB,MAAKA,aAAL,CAAmBJ,IAAnB,uDAArB;AAZiB;AAalB;;;;yCAIoB;AAAA;;AACnBnB,MAAAA,EAAE,CAACwB,GAAH,CAAO3B,IAAP,EACG4B,IADH,CACQ,UAAA5B,IAAI,EAAI;AAEZA,QAAAA,IAAI,CAAC6B,OAAL,CAAa,UAAAC,CAAC;AAAA,iBAAIA,CAAC,CAACC,MAAF,GAAW,CAACD,CAAC,CAACC,MAAlB;AAAA,SAAd;AAEA/B,QAAAA,IAAI,CAACgC,IAAL,CAAU,UAACC,CAAD,EAAGC,CAAH;AAAA,iBAASA,CAAC,CAACH,MAAF,GAAWE,CAAC,CAACF,MAAtB;AAAA,SAAV;;AAEA,QAAA,MAAI,CAACI,QAAL,CAAc;AACZnC,UAAAA,IAAI,EAAJA;AADY,SAAd;AAID,OAXH;AAYD;;;mCAEcoC,K,EAAO;AACpB,WAAKD,QAAL,CAAc;AACZhB,QAAAA,KAAK,EAAEiB,KAAK,CAACC,MAAN,CAAalB;AADR,OAAd;AAGD;;;kCAEa;AACZ,WAAKgB,QAAL,CAAc;AACZhB,QAAAA,KAAK,EAAE;AADK,OAAd;AAGD;;;8BAESiB,K,EAAOE,O,EAAS;AAExB,UAAMpB,SAAS,GAAG,KAAKV,KAAL,CAAWU,SAAX,KAAyB,KAAzB,GAAiC,MAAjC,GAA0C,KAA5D;AAEA,UAAMqB,UAAU,GAAG,KAAK/B,KAAL,CAAWR,IAA9B;;AAEA,UAAIsC,OAAO,KAAK,QAAhB,EAA0B;AACxBE,QAAAA,OAAO,CAACC,GAAR,CAAYvB,SAAS,KAAK,MAA1B;AACDA,QAAAA,SAAS,KAAK,MAAd,GAAuBqB,UAAU,CAACP,IAAX,CAAgB,UAACC,CAAD,EAAGC,CAAH;AAAA,iBAASA,CAAC,CAACH,MAAF,GAAWE,CAAC,CAACF,MAAtB;AAAA,SAAhB,CAAvB,GAAuEQ,UAAU,CAACP,IAAX,CAAgB,UAACC,CAAD,EAAGC,CAAH;AAAA,iBAASD,CAAC,CAACF,MAAF,GAAWG,CAAC,CAACH,MAAtB;AAAA,SAAhB,CAAvE;AACC,aAAKI,QAAL,CAAc;AACZI,UAAAA,UAAU,EAAVA,UADY;AAEZrB,UAAAA,SAAS,EAAEA;AAFC,SAAd;AAID,OAPD,MAQK;AAEHqB,QAAAA,UAAU,CAACP,IAAX,CAAgB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACxB,cAAIQ,KAAK,GAAGT,CAAC,CAACK,OAAD,CAAD,CAAWK,WAAX,EAAZ,CADwB,CACc;;AACtC,cAAIC,KAAK,GAAGV,CAAC,CAACI,OAAD,CAAD,CAAWK,WAAX,EAAZ,CAFwB,CAEc;;AACtC,cAAID,KAAK,GAAGE,KAAZ,EAAmB;AACjB,mBAAO,CAAC,CAAR;AACD;;AACD,cAAIF,KAAK,GAAGE,KAAZ,EAAmB;AACjB,mBAAO,CAAP;AACD,WARuB,CAUxB;;;AACA,iBAAO,CAAP;AACD,SAZD;;AAcA,YAAI1B,SAAS,KAAK,MAAlB,EAA0B;AACxBqB,UAAAA,UAAU,CAACM,OAAX;AACC;;AAGH,aAAKV,QAAL,CAAc;AACZI,UAAAA,UAAU,EAAVA,UADY;AAEZrB,UAAAA,SAAS,EAAEA;AAFC,SAAd;AAID;AAEF;;;oCAEe;AACd,WAAKiB,QAAL,CAAc;AACVf,QAAAA,cAAc,EAAE;AADN,OAAd;AAGD;;;oCAEe;AACd,WAAKe,QAAL,CAAc;AACVf,QAAAA,cAAc,EAAE;AADN,OAAd;AAGD;;;6BAEQ;AAAA;;AAEP,UAAI,KAAKZ,KAAL,CAAWR,IAAX,CAAgB8C,MAAhB,GAAyB,CAA7B,EAAgC;AAC9B,YAAI9C,IAAI,GAAG,KAAKQ,KAAL,CAAWR,IAAtB;AAEF,YAAI+C,OAAO,GAAG,CAAC,QAAD,EAAW,UAAX,EAAuB,OAAvB,EAAgC,UAAhC,EAA2C,UAA3C,EAAwD,MAAxD,CAAd;;AAEE,YAAIC,YAAY,GAAG5C,CAAC,CAAC6C,GAAF,CAAMjD,IAAN,EAAY,UAAA8B,CAAC,EAAI;AAC9B,iBAAO1B,CAAC,CAAC8C,IAAF,CAAOpB,CAAP,EAAU,CAAC,MAAD,EAAS,UAAT,EAAqB,MAArB,EAA6B,UAA7B,EAAyC,gBAAzC,EAA2D,OAA3D,EAAoE,QAApE,EAA8E,OAA9E,CAAV,CAAP;AACD,SAFc,CAAnB;;AAIA,YAAI,KAAKtB,KAAL,CAAWY,cAAX,KAA8B,IAAlC,EAAwC;AACtC4B,UAAAA,YAAY,CAACnB,OAAb,CAAqB,UAACC,CAAD,EAAIqB,CAAJ,EAAU;AAC7BrB,YAAAA,CAAC,CAACsB,KAAF,GAAUD,CAAV;AACD,WAFD;AAIAH,UAAAA,YAAY,GAAGA,YAAY,CAACK,MAAb,CAAoB,UAAAvB,CAAC;AAAA,mBAAIA,CAAC,CAACsB,KAAF,GAAU,EAAd;AAAA,WAArB,CAAf;AACD;;AAGD,YAAIE,OAAO,GAAG,KAAK9C,KAAL,CAAWW,KAAX,KAAqB,wCAArB,GAAgE6B,YAAhE,GAA+EA,YAAY,CAACK,MAAb,CAAoBhD,UAAU,CAAC,KAAKG,KAAL,CAAWW,KAAZ,CAA9B,CAA7F;AAGD;;AAED,UAAMoC,YAAY,sBAAOC,KAAK,CAAC,EAAD,CAAL,CAAUC,IAAV,EAAP,CAAlB;;AACAF,MAAAA,YAAY,CAACG,KAAb;AAEA,UAAIC,MAAM,GAAGxD,EAAE,CAACyD,YAAH,GACXC,MADW,CACJN,YADI,EAEXO,KAFW,CAEL,CAAC,SAAD,EAAW,SAAX,EAAqB,SAArB,EAA+B,SAA/B,EAAyC,SAAzC,EAAoD,SAApD,EAA+D,SAA/D,EAA0E,SAA1E,EAAqF,SAArF,EAAgG,SAAhG,CAFK,CAAb;;AAIIC,MAAAA,MAAM,CAACC,SAAP,CAAiBC,UAAjB,GAA8B,YAAW;AACzC,eAAO,KAAKC,MAAL,CAAY,CAAZ,EAAevB,WAAf,KAA+B,KAAKwB,KAAL,CAAW,CAAX,CAAtC;AACC,OAFD;;AAIJ,UAAMC,WAAW,GAAGC,QAAQ,CAACC,cAAT,CAAwB,cAAxB,CAApB;;AACA,UAAIF,WAAW,KAAK,IAApB,EAA0B;AACzB,aAAK5D,KAAL,CAAWY,cAAX,KAA8B,IAA9B,GAAqCgD,WAAW,CAACG,SAAZ,GAAwB,WAA7D,GAA2EH,WAAW,CAACG,SAAZ,GAAwB,WAAnG;AACA;;AAED,aACA;AAAK,QAAA,SAAS,EAAG,aAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAO,QAAA,OAAO,EAAI,KAAK/C,WAAvB;AAAoC,QAAA,GAAG,EAAK,aAAAgD,IAAI;AAAA,iBAAI,MAAI,CAACA,IAAL,GAAYA,IAAhB;AAAA,SAAhD;AAAuE,QAAA,SAAS,EAAG,UAAnF;AAA8F,QAAA,IAAI,EAAG,MAArG;AAA4G,QAAA,MAAM,EAAE,KAAKjD,cAAzH;AAAyI,QAAA,WAAW,EAAC,wCAArJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADF,EAIC;AAAK,QAAA,KAAK,EAAI;AAACkD,UAAAA,MAAM,EAAE;AAAT,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADA,CAJD,EAOE;AAAO,QAAA,SAAS,EAAE,OAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAO,QAAA,EAAE,EAAG,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEC1B,OAAO,KAAK2B,SAAZ,GAAwB3B,OAAO,CAACE,GAAR,CAAY,UAACnB,CAAD,EAAIqB,CAAJ;AAAA,eACjC;AAAI,UAAA,SAAS,EAAG,eAAhB;AAAgC,UAAA,OAAO,EAAI,iBAAAwB,CAAC;AAAA,mBAAI,MAAI,CAACtD,SAAL,CAAesD,CAAf,EAAkB7C,CAAlB,CAAJ;AAAA,WAA5C;AAAsE,UAAA,GAAG,EAAI,YAAYqB,CAAzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACCrB,CAAC,CAACmC,UAAF,EADD,EAEA;AAAK,UAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAK,UAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,EAEE;AAAK,UAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF,CAFA,CADiC;AAAA,OAAZ,CAAxB,GAQO,IAVR,CADA,CADF,EAgBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAGEX,OAAO,KAAKoB,SAAZ,GAAwBpB,OAAO,CAACL,GAAR,CAAY,UAACnB,CAAD,EAAGqB,CAAH;AAAA,eAClC;AAAI,UAAA,GAAG,EAAI,QAAQA,CAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAEEG,OAAO,KAAKoB,SAAZ,GAAyB3B,OAAO,CAACE,GAAR,CAAY,UAAC2B,GAAD,EAAMzB,CAAN;AAAA,iBACrC;AAAI,YAAA,GAAG,EAAIyB,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAiB;AAAM,YAAA,SAAS,EAAIA,GAAG,KAAK,QAAR,GAAmB,QAAnB,GAA8B,QAAjD;AAA2D,YAAA,KAAK,EAAI;AAACC,cAAAA,UAAU,EAAED,GAAG,KAAK,QAAR,GAAmBjB,MAAM,CAAC7B,CAAC,CAAC8C,GAAD,CAAF,CAAzB,GAAoC,OAAjD;AAA0DE,cAAAA,KAAK,EAAEF,GAAG,KAAK,QAAR,GAAmB,OAAnB,GAA6B9C,CAAC,CAACiD,QAAF,KAAe,EAAf,GAAoB,OAApB,GAA8B;AAA5H,aAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAA4MjD,CAAC,CAAC8C,GAAD,CAA7M,MAAjB,MADqC;AAAA,SAAZ,CAAzB,GAEI,IAJN,CADkC;AAAA,OAAZ,CAAxB,GAQM,IAXR,CAhBA,CAPF,EAsCE;AAAQ,QAAA,OAAO,EAAI,KAAKpE,KAAL,CAAWY,cAAX,KAA8B,KAA9B,GAAqC,KAAKK,aAA1C,GAA0D,KAAKC,aAAlF;AAAkG,QAAA,EAAE,EAAC,cAArG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAtCF,CADA;AA0CD;;;;EAvLsBzB,KAAK,CAAC+E,S;;AA0L/B,eAAelE,UAAf","sourcesContent":["import data from './endorsements-2020.csv';\nconst React = require(\"react\")\nconst d3 = require(\"d3\")\nconst _ = require('lodash');\n\nfunction isSearched(searchTerm) {\n  return function(item) {\n    return (item.state.toLowerCase().includes(searchTerm.toLowerCase().trim()) || item.position.toLowerCase().includes(searchTerm.toLowerCase().trim()) || item.endorser.toLowerCase().includes(searchTerm.toLowerCase().trim()))\n  }\n}\n\n\nclass TotalTable extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      data: [],\n      direction: \"desc\",\n      value: \"Search by position, state, or endorser\",\n      totalTableMore: true\n    };\n    this.sortTable = this.sortTable.bind(this)\n    this.onSearchChange = this.onSearchChange.bind(this)\n    this.searchClick = this.searchClick.bind(this)\n    this.showMoreTotal = this.showMoreTotal.bind(this)\n    this.showLessTotal = this.showLessTotal.bind(this)\n  }\n\n  anchorRef = React.createRef()\n\n  componentWillMount() {\n    d3.csv(data)\n      .then(data => {\n\n        data.forEach(d => d.points = +d.points)\n\n        data.sort((a,b) => b.points - a.points)\n\n        this.setState({\n          data\n        })\n\n      })\n  }\n\n  onSearchChange(event) {\n    this.setState({\n      value: event.target.value\n    })\n  }\n\n  searchClick() {\n    this.setState({\n      value: \"\"\n    })\n  }\n\n  sortTable(event, sortKey) {\n\n    const direction = this.state.direction === 'asc' ? 'desc' : 'asc';\n\n    const dataSorted = this.state.data;\n\n    if (sortKey === \"points\") {\n      console.log(direction === \"desc\")\n     direction === \"desc\" ? dataSorted.sort((a,b) => b.points - a.points) : dataSorted.sort((a,b) => a.points - b.points)\n      this.setState({\n        dataSorted,\n        direction: direction\n      })\n    }\n    else {\n\n      dataSorted.sort((a, b) => {\n        var nameA = a[sortKey].toUpperCase(); // ignore upper and lowercase\n        var nameB = b[sortKey].toUpperCase(); // ignore upper and lowercase\n        if (nameA < nameB) {\n          return -1;\n        }\n        if (nameA > nameB) {\n          return 1;\n        }\n\n        // names must be equal\n        return 0;\n      });\n\n      if (direction === 'desc') {\n        dataSorted.reverse();\n        }\n\n\n      this.setState({\n        dataSorted,\n        direction: direction\n      })\n    }\n\n  }\n\n  showMoreTotal() {\n    this.setState({\n        totalTableMore: false,\n      })\n  }\n\n  showLessTotal() {\n    this.setState({\n        totalTableMore: false,\n      })\n  }\n\n  render() {\n\n    if (this.state.data.length > 0) {\n      var data = this.state.data\n\n    var columns = [\"points\", \"position\", \"state\", \"endorser\",\"endorsee\",  \"date\"]\n\n      var dataFiltered = _.map(data, d => {\n            return _.omit(d, ['city', 'category', \"body\", \"district\", \"endorser party\", \"order\", \"source\", \"index\"])\n          })\n\n      if (this.state.totalTableMore === true) {\n        dataFiltered.forEach((d, i) => {\n          d.index = i\n        })\n\n        dataFiltered = dataFiltered.filter(d => d.index < 15)\n      }\n\n\n      var dataNew = this.state.value === \"Search by position, state, or endorser\" ? dataFiltered : dataFiltered.filter(isSearched(this.state.value))\n\n\n    }\n\n    const points_array = [...Array(11).keys()]\n    points_array.shift()\n\n    var colors = d3.scaleOrdinal()\n     .domain(points_array)\n     .range([\"#c2dbef\",\"#b3d2eb\",\"#a3c9e7\",\"#94c0e3\",\"#84b7de\", \"#75adda\", \"#65a4d6\", \"#569bd2\", \"#4692ce\", \"#3689ca\"])\n\n        String.prototype.capitalize = function() {\n        return this.charAt(0).toUpperCase() + this.slice(1);\n        }\n\n    const total_table = document.getElementById(\"total_button\")\n    if (total_table !== null) {\n     this.state.totalTableMore === true ? total_table.innerText = \"Show More\" : total_table.innerText = \"Show Less\"\n    }\n\n    return (\n    <div className = \"table_input\">\n      <form>\n          <input onClick = {this.searchClick} ref = { node => this.node = node } className = \"seachbox\" type = \"text\" onBlur={this.onSearchChange} placeholder=\"Search by position, state, or endorser\" />\n     </form>\n     <div style = {{height: 50}}>\n     <br />\n     </div>\n      <table className =\"table\">\n        <thead id  =\"headers\">\n        <tr>\n        {\n         columns !== undefined ? columns.map((d, i) =>\n            <th className = \"total_headers\" onClick = {e => this.sortTable(e, d)} key = {\"columns\" + i}>\n            {d.capitalize()}\n            <div className=\"sortdir\">\n              <div className=\"desc\">▲</div>\n              <div className=\"asc\">▼</div>\n            </div>\n            </th>\n            ) : null\n        }\n        </tr>\n      </thead>\n      <tbody>\n      {\n\n        dataNew !== undefined ? dataNew.map((d,i) =>\n          <tr key = {\"row\" + i}>\n          {\n            dataNew !== undefined ?  columns.map((col, i) =>\n            <td key = {col}> <span className = {col === \"points\" ? \"points\" : \"others\"} style = {{background: col === \"points\" ? colors(d[col]) : \"white\", color: col === \"points\" ? \"white\" : d.endorsee !== \"\" ? \"black\" : \"#999\"}}> { d[col] } </span> </td>\n            ) : null\n          }\n          </tr>\n          ) : null\n      }\n      </tbody>\n      </table>\n      <button onClick = {this.state.totalTableMore === false? this.showMoreTotal : this.showLessTotal } id=\"total_button\"> Show More </button>\n      </div>\n      )\n  }\n}\n\nexport default TotalTable"]},"metadata":{},"sourceType":"module"}